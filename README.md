# Big vegetable fights
#### or my web bonus task

### Игра
В игре два режима:
- **Move-after-move режим.** 
Игра происходит последовательно: 
сначала ходите вы, потом ваши враги. И так до тех пор,
пока вы не умрёте. Или не выиграете. Чтобы выиграть, нужно
выжить в течение 40 (по умолчанию) ходов.
- **Async режим.** Все ходят одновременно, а способности
восстанавливаются всё время. Чтобы выиграть, нужно выжить
в течение 3 (по умолчанию) минут.

Открыв index.html или async.html, вы должны увидеть экран
выбора персонажа:
![Alt-текст](./description/images/1.png 'Экран выбора героя')

На этом экране можно переключаться между режимами (чёрная кнопка)
И выбирать персонажей.

Выбрав персонажа, можно начать игру кнопкой `Confirm`.

Откроется экран ведения боя:
![Alt-текст](./description/images/2.png 'Экран ведения боя')

Для выбора умения нажмите на любую доступную карточку.
Такие карточки реагируют на наведение мышью, а progress-bar
их готовности имеет сплошной синий цвет.

В зависимости от типа умения для клика станет доступной либо
карточка героя, либо карточка врага. Выберите, к кому хотите
применить умение, и оно применится.

За применение каждого из умений вы получите некоторую
прибавку к счёту. Это отобразится в меню прогресса.

Аналогично, вы получите 1000 баллов за каждого убитого врага.
Убийство врага также отобразится в отдельной строке.

В поле `Logs` вы можете просмотреть логи боя, как это ни очевидно.

Когда игра завершится, вы увидите экран результатов:
![Alt-текст](./description/images/3.png 'Экран результатов')


### Редактирование
Все игровые константы, все герои, враги и перки хранятся в
файле
`web-bonus/store.json`

Редактируя этот файл, вы можете влиять на сложность игры, а также
добавлять новые возможности.

#### Добавление героя
Чтобы добавить нового героя для выбора, найдите массив `heroes`.
Вы можете добавить следующие параметры:
- `id`. Рекомендуется устанавливать равной порядковому номеру
(от нуля) в массиве.
- `hp`. Максимальное здоровье героя.
- `mana`. Максимальная мана героя.
- `skills`. Способности героя. Список индексов в массиве `perks`. 
Это именно порядковые номера способностей, не id!
- `name`. То, под каким именем герой будет отображаться везде,
где это необходимо.
- `motto`. Жизненное кредо героя. Отображается во время битвы
на карточке героя под именем.
- `firstDescription`. Отображается под именем на карточке
выбора.
- `secondDescription`. Отображается под первым описанием
на карточке выбора
- `answer`. Реакция героя на выбор. Появится в строке реакции
- `reaction`. Дополнительная реакция. Задаётся как тело
функции, вызываемой при клике на карточку выбора. В теле функции
может использоваться элемент `$card` типа JQuery, который содержит
JQuery-вариант карточки, на которую производился клик. Вы можете
посредством JQuery манипулировать с карточкой, или использовать любую другую
реакцию, например, никто не запрещает вам просто снести весь DOM. 
Требуется ставить `;` везде, где это необходимо по правилам js. 
Тело функции должно быть записано в одну строку.

Все параметры, кроме `reaction`, являются обязательными. Если не прописать
`reaction`, при клике на карточку произойдёт только базовая реакция 
(с использованием строки `answer`).

#### Добавление врага
Чтобы добавить нового врага, найдите массив `enemies`.
Параметры те же, что и для `heroes`, однако можно обойтись без параметров
`firstDescription`, `secondDescription`, `answer` и `reaction`, так как
враги не задействуются на экране выбора персонажа.

#### Добавление способности
Чтобы добавить новую способность, найдите массив `perks`.
Именно из этого массива берутся индексы для способностей героев и врагов 
(параметр `skills`).

Способности имеют базовые параметры:
- `mana`. Чем выше значение параметра - тем дольше восполняется способность.
Не выставляйте этому параметру значение 0 - способность всё время будет
недоступной.
- `fighterManaDemand`. Количество маны бойца, отнимаемой при применении
способности.
- `forSelf`. Логический параметр. Если его значение true, то способность
применяется на себя, иначе - на врага.

Текстовые параметры:
- `name`. Название способности
- `info`. Краткое описание способности, отображаемое на карточке
- `actionString`. Строка, появляющаяся в логах при использовании способности.

Если способность применяется на себя, то итоговая строка будет выглядеть как
`Кукумбер сломал стол`, где Кукумбер - имя применителя, а 'сломал стол' - 
_actionString_.

Если способность применяется на врага, то итоговая строка будет выглядеть как
`Кукумбер сломал стол Томатус`, где Томатус - имя противника, к которому
применили эффект.

Это важно учитывать при формулировании _actionString_.

Для способностей, которые используются героем, необходимо задать параметр:
- `score`. Количество очков, прибавляемых при применении умения

Для анимируемых способностей необходимо задать:
- `id`. Имеет числовой тип.
- `countOfImages`. Количество картинок для анимации.

Далее зайдите в папку web-bonus/images/animation/ и создайте в ней папку
с названием таким же, как id способности. В эту папку добавьте все картинки анимации.

Все картинки должны иметь формат png, а их названия записаны как
image_part_[номер картинки].png 

Номер картинки должен быть дополнен незначащими нулями до трёх цифр. Нумерацию
необходимо начинать с 001 и до значения параметра `countOfImages`.

Если не задать `countOfImages`, способность не будет анимироваться.

Наконец, самое важное для любой способности:
- `effect`. Тело функции, вызываемой при применении эффекта.

В теле функции можно использовать следующие переменные:
* *target* - целевой объект типа Fighter, к которому применяется эффект. 
Для него, как и для прочих объектов этого типа, допустимо использовать
следующие методы и свойства:
``` typescript
target.addHp(count: number); //добавляет count к здоровью цели. count может быть отрицательным

target.addMana(count: number); //добавляет count к ману цели. count может быть отрицательным

target.hp //напрямую получить или установить здоровье цели. Преобразование отразится сразу
         //и на карточке
         
target.mana //аналогично target.hp

target.prototype //возвращает объекта типа FighterPrototype только для чтения. 
                //FighterPrototype содержит те же параметры, что были заданы в store
               //для героев или врагов
               
target.wereRemoved //проверяет, был ли уничтожен объект. Бессмысленно использовать, если
                  //выше нигде не вызывалось target.addHp(count)
                  
target.getCoords(); //возвращает координаты карточки бойца

target.getCard(); //возвращает объект класса FighterCard. Возможно следующее использование:

target.getCard().getCard(); //возвращает объект типа JQuery - карточку бойца. С ней можно
                           //взаимодействовать посредством jquery, например, изменить цвет
                          //фона
```

* *owner* - объект-заклинатель. Также имеет тип Fighter, 
а потому имеет все те же методы и свойства, что и *target*.

* *game* - сама игра, имеет класс Game. Для неё допустимо использовать методы и свойства:
``` typescript
game.enemies //список врагов. Враги имеют тип Enemy, наследующий класс Fighter.
            //На основе списка можно применить эффект к нескольким врагам, или проверить,
           //принадлежат ли списку target и owner.
           
game.hero //игрок. Имеет тип Hero, наследующий Fighter. Можно сравнить с target и owner
         //или применить эффект исключительно к герою, независимо от заклинателя и от цели
         
game.addEnemy() //добавляет случайного врага на основе прототипов из store.enemies

game.addEnemy(index: number) //добавляет врага, имеющего порядковый номер
                            //index в массиве прототипов store.enemies
                            
game.addEnemy({
    id: number,
    name: string,
    hp: number, 
    mana: number, 
    skills: number[], 
    motto: string
}); //добавляет врага по указанному прототипу. Следует использовать в том случае, когда
   //вы не хотите, чтобы по данному прототипу создавались случайные враги. Например,
  //используя это умения можно создать врага-предателя, лечащего героя.
 //важно: все атрибуты должны присутсвовать в объекте!
 
game.addLog(maker: Fighter, target: Fighter, actionString: string) //добавляет
                //дополнительную строку в логи
                
game.addScore(count: number) //увеличивает счёт на значение count
```

* *Util* - предоставляет полезные методы:
``` typescript
Util.sleep(ms: number) //Возвращает промис ожидания

Util.randomInt(min: number, max: number) //Возвращает рандомное целое 
                                        //число в диапазоне [min, max)
                                        
Util.fireworks() //Запускает салют. Возвращает промис
```

Аналогично функции для дополнительной реакции героя, функция-эффект способности записывается
сплошной строкой по правилам js.
